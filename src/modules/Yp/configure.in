# $Id: configure.in,v 1.8 1998/09/20 08:32:45 hubbe Exp $
AC_INIT(yp.c)
AC_CONFIG_HEADER(config.h)

AC_MODULE_INIT()

AC_CHECK_LIB(nsl, gethostbyname)

AC_HAVE_HEADERS(sys/types.h rpc/types.h rpc/rpc.h rpc/clnt.h rpcsvc/ypclnt.h rpcsvc/yp_prot.h)

#
# yp_order() is
#
# yp_order(char *, char *, int *)		On most BSD's
# yp_order(char *, char *, unsigned int *)	On OSF/1
# yp_order(char *, char *, unsigned long *)	On SysV's
#
# int and unsigned int have the same size, so we only test if the last
# arg's an unsigned long * or not.
#
AC_MSG_CHECKING(the type of the last argument to yp_order)
AC_CACHE_VAL(pike_cv_yp_order_type, [
  AC_TRY_COMPILE([
#include "global.h"
#ifdef HAVE_SYS_TYPES_H
#include <sys/types.h>
#endif /* HAVE_SYS_TYPES_H */
#ifdef HAVE_RPC_TYPES_H
#include <rpc/types.h>
#endif /* HAVE_RPC_TYPES_H */
#ifdef HAVE_RPC_RPC_H
#include <rpc/rpc.h>
#endif /* HAVE_RPC_RPC_H */
#ifdef HAVE_RPC_CLNT_H
#include <rpc/clnt.h>
#endif /* HAVE_RPC_CLNT_H */
#include <rpcsvc/yp_prot.h>
#include <rpcsvc/ypclnt.h>

int yp_order(char *, char *, unsigned long *);
  ],[
    /* EMPTY */
  ],[ pike_cv_yp_order_type="unsigned long" ], [
    AC_TRY_COMPILE([
#include "global.h"
#ifdef HAVE_SYS_TYPES_H
#include <sys/types.h>
#endif /* HAVE_SYS_TYPES_H */
#ifdef HAVE_RPC_TYPES_H
#include <rpc/types.h>
#endif /* HAVE_RPC_TYPES_H */
#ifdef HAVE_RPC_RPC_H
#include <rpc/rpc.h>
#endif /* HAVE_RPC_RPC_H */
#ifdef HAVE_RPC_CLNT_H
#include <rpc/clnt.h>
#endif /* HAVE_RPC_CLNT_H */
#include <rpcsvc/yp_prot.h>
#include <rpcsvc/ypclnt.h>

int yp_order(const char *, const char *, unsigned long *);
    ],[
    /* EMPTY */
    ],[ pike_cv_yp_order_type="unsigned long" ], [
      AC_TRY_COMPILE([
#include "global.h"
#ifdef HAVE_SYS_TYPES_H
#include <sys/types.h>
#endif /* HAVE_SYS_TYPES_H */
#ifdef HAVE_RPC_TYPES_H
#include <rpc/types.h>
#endif /* HAVE_RPC_TYPES_H */
#ifdef HAVE_RPC_RPC_H
#include <rpc/rpc.h>
#endif /* HAVE_RPC_RPC_H */
#ifdef HAVE_RPC_CLNT_H
#include <rpc/clnt.h>
#endif /* HAVE_RPC_CLNT_H */
#include <rpcsvc/yp_prot.h>
#include <rpcsvc/ypclnt.h>

int yp_order(char *, char *, long *);
      ],[
    /* EMPTY */
      ],[ pike_cv_yp_order_type="unsigned long" ], [
        AC_TRY_COMPILE([
#include "global.h"
#ifdef HAVE_SYS_TYPES_H
#include <sys/types.h>
#endif /* HAVE_SYS_TYPES_H */
#ifdef HAVE_RPC_TYPES_H
#include <rpc/types.h>
#endif /* HAVE_RPC_TYPES_H */
#ifdef HAVE_RPC_RPC_H
#include <rpc/rpc.h>
#endif /* HAVE_RPC_RPC_H */
#ifdef HAVE_RPC_CLNT_H
#include <rpc/clnt.h>
#endif /* HAVE_RPC_CLNT_H */
#include <rpcsvc/yp_prot.h>
#include <rpcsvc/ypclnt.h>

int yp_order(const char *, const char *, long *);
      ],[
    /* EMPTY */
      ],[ pike_cv_yp_order_type="unsigned long" ],
        [ pike_cv_yp_order_type="unsigned int" ])
      ])
    ])
  ])
])
AC_DEFINE_UNQUOTED(YP_ORDER_TYPE, $pike_cv_yp_order_type)
AC_MSG_RESULT($pike_cv_yp_order_type)

AC_OUTPUT(Makefile,echo FOO >stamp-h )
