SRCDIR=@srcdir@
VPATH=@srcdir@:@srcdir@/../../..:../../..
GIF_OBJS = gif.o gif_lzw.o png.o
JPEG_OBJS = jpeg.o
PNG_OBJS = png.o
PNM_OBJS = pnm.o 
X_OBJS = x.o
OBJS=gif.a pnm.a png.a x.a

@SET_MAKE@

CC=@CC@
CPP=@CPP@
AR=ar
RANLIB=@RANLIB@

PREFLAGS=-I. -I$(SRCDIR) -I$(SRCDIR)/../../.. -I$(SRCDIR)/.. -I../../.. -I.. -I. $(MODULE_CPPFLAGS) $(DEFINES) 
CFLAGS=$(PREFLAGS) $(OTHERFLAGS) $(MODULE_CFLAGS) @CCSHARED@ 

all: $(OBJS)

gif.a : $(GIF_OBJS)
	rm -f gif.a
	$(AR) cq gif.a $(GIF_OBJS)
	$(RANLIB) gif.a

x.a : $(X_OBJS)
	rm -f x.a
	$(AR) cq x.a $(X_OBJS)
	$(RANLIB) x.a

png.a : $(PNG_OBJS)
	rm -f png.a
	$(AR) cq png.a $(PNG_OBJS)
	$(RANLIB) png.a

jpeg.a : $(JPEG_OBJS)
	rm -f jpeg.a
	$(AR) cq jpeg.a $(JPEG_OBJS)
	$(RANLIB) jpeg.a

pnm.a : $(PNM_OBJS)
	rm -f pnm.a
	$(AR) cq pnm.a $(PNM_OBJS)
	$(RANLIB) pnm.a

depend:
	gcc -MM $(PREFLAGS) $(SRCDIR)/*.c | $(TMP_BINDIR)/fixdepends.sh $(SRCDIR)

clean:
	-rm -f *.o *.a *.so module.so

pike: all
	cd ../../..; $(MAKE)

pure: all
	cd ../../..; $(MAKE) pure

Makefile: $(SRCDIR)/Makefile.in $(SRCDIR)/dependencies
	CONFIG_FILES=Makefile CONFIG_HEADERS= ./config.status
	@echo "Run make again"
	@exit 1

@dependencies@
