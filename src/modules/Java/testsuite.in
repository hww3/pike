START_MARKER
// $Id: testsuite.in,v 1.8 2007/06/19 18:51:11 mast Exp $

cond( [[ master()->resolv("Java")->jvm ]],
[[
  test_true([[objectp(Java)]])
  test_true([[objectp(Java.pkg)]])
  test_true([[objectp(Java.pkg.java.lang.String)]])
  test_eq([[(string)Java.pkg.java.lang.String()->concat("FOO")
	->toLowerCase()]],"foo")
  test_eq([[(string)Java.pkg.java.lang.Character(4711)]],"\11147")
  test_do(Stdio.write_file("conftest.class", MIME.decode_base64(#"
yv66vgADAC0ANQcAJQcAKQcAKgcAKwcALAoAAwAQCgAFABEKAAEAEgoABQATCgAFABQJAAEAFQkA
AQAWCQABABcJAAEAGAkAAQAZDAAdABoMAB0AHAwAKAAbDAAtABoMAC8AGgwAMAAeDAAxACAMADIA
IwwAMwAhDAA0ACABAAMoKVYBAAcoQkRTSSlEAQAXKExqYXZhL2xhbmcvUnVubmFibGU7KVYBAAY8
aW5pdD4BAAFCAQAEQ29kZQEAAUQBAAFJAQAPTGluZU51bWJlclRhYmxlAQABUwEAClNvdXJjZUZp
bGUBAAhjb25mdGVzdAEADWNvbmZ0ZXN0LmphdmEBAAVlbnRyeQEABGZ1bmMBAB5qYXZhL2xhbmcv
SW50ZXJydXB0ZWRFeGNlcHRpb24BABBqYXZhL2xhbmcvT2JqZWN0AQASamF2YS9sYW5nL1J1bm5h
YmxlAQAQamF2YS9sYW5nL1RocmVhZAEABGpvaW4BAANydW4BAAVzdGFydAEABXZhcl9hAQAFdmFy
X2IBAAV2YXJfYwEABXZhcl9kAQAHdmFyX3JlcwAhAAEAAwABAAQABQACADAAHgAAAAIAMQAgAAAA
AgAyACMAAAACADMAIQAAAAIANAAgAAAABAABAB0AGgABAB8AAAAdAAEAAQAAAAUqtwAGsQAAAAEA
IgAAAAYAAQAAAAEAAQAnABsAAQAfAAAAewADAAcAAAAzKhu1AAsqKLUADCoVBLUADSoVBbUADrsA
BVkqtwAHOgYZBrYAChkGtgAJKrQAD69Xp//1AAEAJQAvAC8AAgABACIAAAAuAAsAAAAJAAUACgAK
AAsAEAAMABYADQAgAA4AJQAQACUAEQAqABIALwATADAAEAEMACgAGwAAAAEALgAaAAEAHwAAADQA
BgABAAAAGCoqtAALKrQADCq0AA0qtAAOuAAItQAPsQAAAAEAIgAAAAoAAgAAABgAFwAWAAEAJAAA
AAIAJg==
")))
  test_any([[
#if constant(Java.NATIVE_METHODS)
    object u = Java.pkg.java.io.File->_constructor("(Ljava/lang/String;)")
	(Java.pkg.java.lang.System->getProperty("user.dir"))->toURL();
    object t = Java.pkg.java.net.URLClassLoader(u->_obj->get_object_class()
	->new_array(1,u->_obj))->loadClass("conftest");
    object n = t->_obj->register_natives(({({"func", "(BDSI)D", `+})}));
    return t->newInstance()->entry(17, 42.5, 99, 777);
#else
    write("Warning: Native methods not supported.\n");
    return 935.5;
#endif
  ]],935.5)
  test_do(rm("conftest.class"))
]])
END_MARKER
