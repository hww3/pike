// $Id: testsuite.in,v 1.4 2002/07/30 21:23:30 marcus Exp $

cond( [[ master()->resolv("Java")->jvm ]],
[[
  test_true([[objectp(Java)]])
  test_true([[objectp(Java.pkg)]])
  test_true([[objectp(Java.pkg.java.lang.String)]])
  test_eq([[(string)Java.pkg.java.lang.String()->concat("FOO")
	->toLowerCase()]],"foo")
  test_eq([[(string)Java.pkg.java.lang.Character(4711)]],"\11147")
  test_do(Stdio.write_file("conftest.class", MIME.decode_base64(#"
yv66vgADAC0ALAcAHgcAIgcAIwcAJAcAJQoAAwAOCgAFAA8KAAEAEAoABQARCgAFABIJAAEAEwkA
AQAUCQABABUMABkAFgwAGQAYDAAhABcMACYAFgwAKAAWDAApABsMACoAGwwAKwAbAQADKClWAQAF
KElJKUkBABcoTGphdmEvbGFuZy9SdW5uYWJsZTspVgEABjxpbml0PgEABENvZGUBAAFJAQAPTGlu
ZU51bWJlclRhYmxlAQAKU291cmNlRmlsZQEACGNvbmZ0ZXN0AQANY29uZnRlc3QuamF2YQEABWVu
dHJ5AQAEZnVuYwEAHmphdmEvbGFuZy9JbnRlcnJ1cHRlZEV4Y2VwdGlvbgEAEGphdmEvbGFuZy9P
YmplY3QBABJqYXZhL2xhbmcvUnVubmFibGUBABBqYXZhL2xhbmcvVGhyZWFkAQAEam9pbgEAA3J1
bgEABXN0YXJ0AQAFdmFyX2EBAAV2YXJfYgEAB3Zhcl9yZXMAIQABAAMAAQAEAAMAAgApABsAAAAC
ACoAGwAAAAIAKwAbAAAABAABABkAFgABABoAAAAdAAEAAQAAAAUqtwAGsQAAAAEAHAAAAAYAAQAA
AAEAAQAgABcAAQAaAAAAZAADAAQAAAAkKhu1AAsqHLUADLsABVkqtwAHTi22AAottgAJKrQADaxX
p//2AAEAFwAgACAAAgABABwAAAAmAAkAAAAOAAUADwAKABAAEwARABcAEwAXABQAGwAVACAAFgAh
ABMBDAAhABcAAAABACcAFgABABoAAAAsAAMAAQAAABAqKrQACyq0AAy4AAi1AA2xAAAAAQAcAAAA
CgACAAAACQAPAAcAAQAdAAAAAgAf
")))
  test_eq([[lambda(){
    object u = Java.pkg.java.io.File->_constructor("(Ljava/lang/String;)")
	(Java.pkg.java.lang.System->getProperty("user.dir"))->toURL();
    object t = Java.pkg.java.net.URLClassLoader(u->_obj->get_object_class()
	->new_array(1,u->_obj))->loadClass("conftest");
    object n = t->_obj->register_natives(({({"func", "(II)I", `+})}));
    return t->newInstance()->entry(17, 42);
  }()]],59)
  test_do(rm("conftest.class"))
]])
