AC_INIT(freetype.c)
AC_CONFIG_HEADER(config.h)
AC_ARG_WITH(freetype,     [  --with(out)-freetype       Support Freetype via Freetype 2 (Image.FreeType)],[],[with_freetype=yes])

AC_MODULE_INIT()

if test "x$with_freetype" = "xyes" ; then

  AC_PATH_PROG(FT_CONFIG, freetype-config, no)

  if test "$FT_CONFIG" = "no" ; then
     :
  else
    CFLAGS="$CFLAGS `$FT_CONFIG --cflags`"
    LIBS="$LIBS `$FT_CONFIG --libs`"
    AC_MSG_CHECKING(If freetype actually works)
    AC_TRY_LINK([
#include <freetype/freetype.h> 
], 
[
  FT_Library library;
  FT_Init_FreeType( &library );
], 
[ft_ok=yes], 
[ft_ok=no])
    if test "$ft_ok"=yes ; then
      AC_MSG_RESULT(yes)
      AC_DEFINE(HAVE_LIBFT2)
    else
      AC_MSG_RESULT(no)
    fi
  fi
fi

AC_OUTPUT(Makefile,echo FOO >stamp-h )
