# $Id: configure.in,v 1.9 2004/02/06 15:07:53 nisse Exp $
AC_INIT(nettle.cmod)
AC_CONFIG_HEADER(nettle_config.h)

AC_SET_MAKE

AC_MODULE_INIT()

AC_CHECK_LIB(nettle, nettle_md5_init,
	     have_nettle=yes,
	     have_nettle=no,
	     -lgmp)

if test x$have_nettle=xno ; then
  AC_CHECK_LIB(nettle, md5_init,
	       have_nettle=yes,,
	       -lgmp)
fi

if test x$have_nettle=xyes ; then
   AC_DEFINE([HAVE_LIBNETTLE], 1, [Nettle library available])
   PIKE_FEATURE_OK(Nettle)
else
   AC_MSG_WARN([The nettle library not found.
No crypto functions will be available.]) 
   PIKE_FEATURE_NODEP(Nettle)
fi

# md4 is available in later versions of nettle
AC_HAVE_FUNCS(nettle_md4_init)

AC_MSG_CHECKING([for idea.c])
# Have the patent-encumbered idea files been purged?
if test -f "$srcdir/idea.c" ; then
   AC_MSG_RESULT([found])
   AC_DEFINE([WITH_IDEA], 1, [idea.c available])
else
   AC_MSG_RESULT([no])	
fi

AC_OUTPUT(Makefile,echo FOO >stamp-h )
